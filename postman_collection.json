{
  "info": {
    "name": "M-Pesa Test API Collection",
    "description": "Complete test collection for M-Pesa integrations including STK Push, B2C, and C2B",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Access Token Test",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-token",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-token"]
        },
        "description": "Test M-Pesa access token generation to verify your credentials are configured correctly."
      },
      "response": []
    },
    {
      "name": "2. STK Push Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"phone_number\": \"254712345678\",\n  \"amount\": 100,\n  \"account_reference\": \"TEST-001\",\n  \"transaction_description\": \"Test STK Push Payment\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-stk-push",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-stk-push"]
        },
        "description": "Test Lipa Na M-Pesa Online (STK Push). This sends a payment prompt to the customer's phone."
      },
      "response": []
    },
    {
      "name": "3. B2C Payment Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"phone_number\": \"254712345678\",\n  \"amount\": 100,\n  \"command_id\": \"BusinessPayment\",\n  \"remarks\": \"Test B2C Payment\",\n  \"occasion\": \"Testing\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-b2c",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-b2c"]
        },
        "description": "Test Business to Customer payment. This sends money from your business to a customer's M-Pesa account.\n\nCommand IDs:\n- BusinessPayment: Normal payment\n- SalaryPayment: Salary disbursement\n- PromotionPayment: Promotional payment"
      },
      "response": []
    },
    {
      "name": "4. C2B Registration Test",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-c2b",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-c2b"]
        },
        "description": "Test C2B URL registration with Safaricom. This registers your validation and confirmation URLs."
      },
      "response": []
    },
    {
      "name": "5. C2B Validation Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"TransactionType\": \"Pay Bill\",\n  \"TransID\": \"OEI2AK4Q16\",\n  \"TransTime\": \"20230615143000\",\n  \"TransAmount\": \"100.00\",\n  \"BusinessShortCode\": \"174379\",\n  \"BillRefNumber\": \"LOAN-001\",\n  \"InvoiceNumber\": \"\",\n  \"OrgAccountBalance\": \"10000.00\",\n  \"ThirdPartyTransID\": \"\",\n  \"MSISDN\": \"254712345678\",\n  \"FirstName\": \"John\",\n  \"MiddleName\": \"Doe\",\n  \"LastName\": \"Smith\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-c2b-validation",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-c2b-validation"]
        },
        "description": "Test C2B validation callback. This simulates what Safaricom sends to your validation URL.\n\nNote: BillRefNumber should be a valid loan number or employee ID in your system."
      },
      "response": []
    },
    {
      "name": "6. C2B Confirmation Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"TransactionType\": \"Pay Bill\",\n  \"TransID\": \"OEI2AK4Q16\",\n  \"TransTime\": \"20230615143000\",\n  \"TransAmount\": \"100.00\",\n  \"BusinessShortCode\": \"174379\",\n  \"BillRefNumber\": \"LOAN-001\",\n  \"InvoiceNumber\": \"\",\n  \"OrgAccountBalance\": \"10000.00\",\n  \"ThirdPartyTransID\": \"\",\n  \"MSISDN\": \"254712345678\",\n  \"FirstName\": \"John\",\n  \"MiddleName\": \"Doe\",\n  \"LastName\": \"Smith\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-c2b-confirmation",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-c2b-confirmation"]
        },
        "description": "Test C2B confirmation callback. This simulates what Safaricom sends to your confirmation URL after a successful payment."
      },
      "response": []
    },
    {
      "name": "7. B2C Result Callback Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"Result\": {\n    \"ResultType\": 0,\n    \"ResultCode\": 0,\n    \"ResultDesc\": \"The service request is processed successfully.\",\n    \"OriginatorConversationID\": \"10816-7910404-1\",\n    \"ConversationID\": \"AG_20230615_00004f7e3b9f9e3c9b1e\",\n    \"TransactionID\": \"OEI2AK4Q16\",\n    \"ResultParameters\": {\n      \"ResultParameter\": [\n        {\n          \"Key\": \"TransactionReceipt\",\n          \"Value\": \"OEI2AK4Q16\"\n        },\n        {\n          \"Key\": \"TransactionAmount\",\n          \"Value\": 100\n        },\n        {\n          \"Key\": \"B2CWorkingAccountAvailableFunds\",\n          \"Value\": 50000\n        },\n        {\n          \"Key\": \"B2CUtilityAccountAvailableFunds\",\n          \"Value\": 10000\n        },\n        {\n          \"Key\": \"TransactionCompletedDateTime\",\n          \"Value\": \"15.06.2023 14:30:00\"\n        },\n        {\n          \"Key\": \"ReceiverPartyPublicName\",\n          \"Value\": \"254712345678 - John Doe\"\n        },\n        {\n          \"Key\": \"B2CChargesPaidAccountAvailableFunds\",\n          \"Value\": 0\n        },\n        {\n          \"Key\": \"B2CRecipientIsRegisteredCustomer\",\n          \"Value\": \"Y\"\n        }\n      ]\n    }\n  }\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-b2c-result",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-b2c-result"]
        },
        "description": "Test B2C result callback. This simulates what Safaricom sends to your B2C result URL after processing a payment."
      },
      "response": []
    },
    {
      "name": "8. B2C Timeout Callback Test",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"Result\": {\n    \"ResultType\": 0,\n    \"ResultCode\": 1,\n    \"ResultDesc\": \"The service request has timed out.\",\n    \"OriginatorConversationID\": \"10816-7910404-1\",\n    \"ConversationID\": \"AG_20230615_00004f7e3b9f9e3c9b1e\",\n    \"TransactionID\": \"\"\n  }\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-b2c-timeout",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-b2c-timeout"]
        },
        "description": "Test B2C timeout callback. This simulates what Safaricom sends when a B2C payment request times out."
      },
      "response": []
    },
    {
      "name": "9. Get Test Transactions",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/v1/mpesa/test-transactions",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "mpesa", "test-transactions"]
        },
        "description": "Retrieve the 20 most recent M-Pesa transactions for debugging purposes."
      },
      "response": []
    }
  ]
}

